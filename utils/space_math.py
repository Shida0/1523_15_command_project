import math
from typing import Dict, Any
from datetime import datetime
import random


def get_size_by_albedo(albedo: float, h_mag: float) -> float:
    """–í—ã—á–∏—Å–ª—è–µ—Ç –¥–∏–∞–º–µ—Ç—Ä –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–ª—å–±–µ–¥–æ –∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ–π –∑–≤—ë–∑–¥–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã."""
    if albedo <= 0:
        raise ValueError(f"–ê–ª—å–±–µ–¥–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º. –ü–æ–ª—É—á–µ–Ω–æ: {albedo}")
    return 1329 / (albedo ** 0.5) * (10 ** (-0.2 * h_mag))


def get_size_by_h_mag(h_mag: float) -> float:
    """–í—ã—á–∏—Å–ª—è–µ—Ç –¥–∏–∞–º–µ—Ç—Ä –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∞–ª—å–±–µ–¥–æ."""
    assumed_albedo = 0.15
    return get_size_by_albedo(assumed_albedo, h_mag)


def calculate_impact_probability(distance_au: float, velocity_km_s: float, 
                                 earth_moid_au: float = None) -> Dict[str, Any]:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ —Å –ó–µ–º–ª–µ–π.
    
    Args:
        distance_au: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–±–ª–∏–∂–µ–Ω–∏—è –≤ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö
        velocity_km_s: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –∫–º/—Å
        earth_moid_au: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ—Ä–±–∏—Ç (MOID), –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –æ—Ü–µ–Ω–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
    """
    # –ë–∞–∑–æ–≤—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    EARTH_RADIUS_KM = 6371
    AU_TO_KM = 149597870.7
    ESCAPE_VELOCITY = 11.186  # –∫–º/—Å (–≤—Ç–æ—Ä–∞—è –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ó–µ–º–ª–∏)
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–º
    distance_km = distance_au * AU_TO_KM
    
    # 1. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (–ø–æ –ø–ª–æ—â–∞–¥–∏)
    # –ü–æ–ø–µ—Ä–µ—á–Ω–æ–µ —Å–µ—á–µ–Ω–∏–µ –ó–µ–º–ª–∏
    earth_cross_section = math.pi * (EARTH_RADIUS_KM ** 2)
    
    # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–ª–æ—â–∞–¥—å —Å—Ñ–µ—Ä—ã —Å —Ä–∞–¥–∏—É—Å–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è —Å–±–ª–∏–∂–µ–Ω–∏—è
    if distance_km > EARTH_RADIUS_KM:
        sphere_surface = 4 * math.pi * (distance_km ** 2)
        geometric_prob = earth_cross_section / sphere_surface
    else:
        geometric_prob = 1.0
    
    # 2. –£—á–µ—Ç –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–∏—è
    # –ß–µ–º –Ω–∏–∂–µ —Å–∫–æ—Ä–æ—Å—Ç—å, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –ó–µ–º–ª—è –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç –∞—Å—Ç–µ—Ä–æ–∏–¥
    gravitational_focusing = 1 + (ESCAPE_VELOCITY / velocity_km_s) ** 2
    enhanced_prob = geometric_prob * gravitational_focusing
    
    # 3. –£—á–µ—Ç MOID (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω)
    moid_factor = 1.0
    if earth_moid_au is not None:
        moid_km = earth_moid_au * AU_TO_KM
        if moid_km > 0:
            # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º MOID
            moid_factor = max(0.1, EARTH_RADIUS_KM / (moid_km * 10))
            enhanced_prob *= moid_factor
    
    # 4. –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
    # –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Ç–æ–ª—å–∫–æ ~30% –æ–±—ä–µ–∫—Ç–æ–≤ —Å distance_au < 0.05 –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–∞–¥–∞—é—Ç
    empirical_factor = 0.3 if distance_au < 0.05 else 0.01
    
    # –ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 100%)
    final_probability = min(1.0, enhanced_prob * empirical_factor * 100)
    
    # –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
    if final_probability >= 50:
        probability_level = "–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è"
        description = "–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è"
    elif final_probability >= 20:
        probability_level = "–≤—ã—Å–æ–∫–∞—è"
        description = "–°—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è"
    elif final_probability >= 5:
        probability_level = "—Å—Ä–µ–¥–Ω—è—è"
        description = "–ó–∞–º–µ—Ç–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —Ç—Ä–µ–±—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
    elif final_probability >= 1:
        probability_level = "–Ω–∏–∑–∫–∞—è"
        description = "–ù–µ–±–æ–ª—å—à–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å"
    elif final_probability >= 0.1:
        probability_level = "–æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è"
        description = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å"
    else:
        probability_level = "–ø—Ä–µ–Ω–µ–±—Ä–µ–∂–∏–º–æ –º–∞–ª–∞—è"
        description = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∫—Ä–∞–π–Ω–µ –º–∞–ª–∞"
    
    return {
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è_–ø—Ä–æ—Ü–µ–Ω—Ç—ã": round(final_probability, 4),
        "—É—Ä–æ–≤–µ–Ω—å_–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏": probability_level,
        "–æ–ø–∏—Å–∞–Ω–∏–µ": description,
        "–≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è_–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å": round(geometric_prob * 100, 6),
        "–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ_—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–∏–µ": round(gravitational_focusing, 2),
        "–ø–æ–ø—Ä–∞–≤–∫–∞_moid": round(moid_factor, 2) if earth_moid_au else "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
        "—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–π_–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç": empirical_factor
    }


def estimate_impact_location(approach_time: datetime, velocity_km_s: float, 
                            distance_au: float) -> Dict[str, Any]:
    """
    –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–µ –º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–±–ª–∏–∂–µ–Ω–∏—è –∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏.
    
    Args:
        approach_time: –í—Ä–µ–º—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–±–ª–∏–∂–µ–Ω–∏—è
        velocity_km_s: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
        distance_au: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å–±–ª–∏–∂–µ–Ω–∏—è
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –æ—Ü–µ–Ω–∫–æ–π –º–µ—Å—Ç–∞ –ø–∞–¥–µ–Ω–∏—è
    """
    # –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å: –≤—Ä–∞—â–µ–Ω–∏–µ –ó–µ–º–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∞—è —á–∞—Å—Ç—å –±—É–¥–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∞ –∫ –∞—Å—Ç–µ—Ä–æ–∏–¥—É
    # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–æ —Å–ª–æ–∂–Ω—ã–π —Ä–∞—Å—á–µ—Ç, –Ω–æ –º—ã —Å–¥–µ–ª–∞–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ –≤ –º–æ–º–µ–Ω—Ç —Å–±–ª–∏–∂–µ–Ω–∏—è (UTC)
    hour = approach_time.hour
    minute = approach_time.minute
    
    # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏–º–µ—Ä–Ω—É—é –¥–æ–ª–≥–æ—Ç—É –ø–∞–¥–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
    # –ó–µ–º–ª—è –≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ 15 –≥—Ä–∞–¥—É—Å–æ–≤ –≤ —á–∞—Å
    base_longitude = (hour + minute/60) * 15
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É (¬±60 –≥—Ä–∞–¥—É—Å–æ–≤) –∏–∑-–∑–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
    longitude_variation = random.uniform(-60, 60)
    estimated_longitude = (base_longitude + longitude_variation) % 360
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–æ—Ä–æ–Ω—É –ó–µ–º–ª–∏ (–¥–Ω–µ–≤–Ω–∞—è/–Ω–æ—á–Ω–∞—è)
    # –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ: 6-18 —á–∞—Å–æ–≤ UTC - –¥–Ω–µ–≤–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞
    if 6 <= hour < 18:
        earth_side = "–¥–Ω–µ–≤–Ω–∞—è"
        visibility = "—Ö–æ—Ä–æ—à–∞—è (–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ)"
    else:
        earth_side = "–Ω–æ—á–Ω–∞—è"
        visibility = "–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è"
    
    # –û—Ü–µ–Ω–∫–∞ —à–∏—Ä–æ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —É–≥–ª–∞ –ø–æ–¥–ª–µ—Ç–∞
    # –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å -> –±–æ–ª–µ–µ –ø–æ–ª—è—Ä–Ω–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è (—É–ø—Ä–æ—â–µ–Ω–∏–µ)
    if velocity_km_s > 20:
        latitude_range = "–≤—ã—Å–æ–∫–∏–µ —à–∏—Ä–æ—Ç—ã (¬±60¬∞-90¬∞)"
        likely_continents = ["–ê–Ω—Ç–∞—Ä–∫—Ç–∏–¥–∞", "—Å–µ–≤–µ—Ä–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –ö–∞–Ω–∞–¥—ã/–†–æ—Å—Å–∏–∏"]
    elif velocity_km_s > 15:
        latitude_range = "—Å—Ä–µ–¥–Ω–∏–µ —à–∏—Ä–æ—Ç—ã (¬±30¬∞-60¬∞)"
        likely_continents = ["–ï–≤—Ä–æ–ø–∞", "–°–µ–≤–µ—Ä–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞", "–ê–∑–∏—è", "—é–≥ –Æ–∂–Ω–æ–π –ê–º–µ—Ä–∏–∫–∏"]
    else:
        latitude_range = "–Ω–∏–∑–∫–∏–µ —à–∏—Ä–æ—Ç—ã (¬±0¬∞-30¬∞)"
        likely_continents = ["–ê—Ñ—Ä–∏–∫–∞", "–Æ–∂–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞", "–Æ–∂–Ω–∞—è –ê–∑–∏—è", "–ê–≤—Å—Ç—Ä–∞–ª–∏—è"]
    
    # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –≤ –æ–∫–µ–∞–Ω (70% –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ó–µ–º–ª–∏ - –≤–æ–¥–∞)
    ocean_probability = 70
    land_probability = 30
    
    # –£—Ç–æ—á–Ω—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –Ω–∞ —Å—É—à—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∏—Ä–æ—Ç—ã
    if "–≤—ã—Å–æ–∫–∏–µ" in latitude_range:
        ocean_probability = 60  # –ú–µ–Ω—å—à–µ –æ–∫–µ–∞–Ω–∞ –≤ –ø–æ–ª—è—Ä–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö
        land_probability = 40
    elif "–Ω–∏–∑–∫–∏–µ" in latitude_range:
        ocean_probability = 75  # –ú–Ω–æ–≥–æ –æ–∫–µ–∞–Ω–∞ –≤ —Ç—Ä–æ–ø–∏–∫–∞—Ö
        land_probability = 25
    
    return {
        "–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è_–¥–æ–ª–≥–æ—Ç–∞_–≥—Ä–∞–¥": round(estimated_longitude, 1),
        "–¥–∏–∞–ø–∞–∑–æ–Ω_–¥–æ–ª–≥–æ—Ç—ã": f"¬±60¬∞ –æ—Ç {round(base_longitude, 1)}¬∞",
        "—Å—Ç–æ—Ä–æ–Ω–∞_–∑–µ–º–ª–∏": earth_side,
        "–≤–∏–¥–∏–º–æ—Å—Ç—å": visibility,
        "–æ–∂–∏–¥–∞–µ–º—ã–π_–¥–∏–∞–ø–∞–∑–æ–Ω_—à–∏—Ä–æ—Ç": latitude_range,
        "–≤–µ—Ä–æ—è—Ç–Ω—ã–µ_–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã": likely_continents,
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–ø–∞–¥–µ–Ω–∏—è_–≤_–æ–∫–µ–∞–Ω_–ø—Ä–æ—Ü–µ–Ω—Ç—ã": ocean_probability,
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–ø–∞–¥–µ–Ω–∏—è_–Ω–∞_—Å—É—à—É_–ø—Ä–æ—Ü–µ–Ω—Ç—ã": land_probability,
        "–≤—Ä–µ–º—è_—Å–±–ª–∏–∂–µ–Ω–∏—è_utc": approach_time.strftime("%Y-%m-%d %H:%M:%S"),
        "–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ": "–≠—Ç–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞. –¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏, —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –∏ —Ç–æ—á–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏."
    }


def count_danger(diameter_km, distance_au, velocity_km_s, 
                 earth_moid_au=None, approach_time=None):
    """
    –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∏–∞–º–µ—Ç—Ä–∞, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ó–µ–º–ª–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.
    –¢–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –æ—Ü–µ–Ω–∫—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–∞–¥–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ—Ä–Ω–æ–≥–æ –º–µ—Å—Ç–∞.
    
    Args:
        diameter_km: –î–∏–∞–º–µ—Ç—Ä –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
        distance_au: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–±–ª–∏–∂–µ–Ω–∏—è –≤ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö
        velocity_km_s: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –∫–º/—Å
        earth_moid_au: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ—Ä–±–∏—Ç (MOID), –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ
        approach_time: –í—Ä–µ–º—è —Å–±–ª–∏–∂–µ–Ω–∏—è (datetime), –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ
        
    Returns:
        –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
    """
    distance_km_value = distance_au * 149597870.7
    
    # –û—Ü–µ–Ω–∫–∞ —É–≥—Ä–æ–∑—ã –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
    if distance_au <= 0.05:
        distance_threat = "–≤—ã—Å–æ–∫–∞—è"
        distance_note = "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—å—à–µ –ø–æ—Ä–æ–≥–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤"
    elif distance_au <= 0.1:
        distance_threat = "—Å—Ä–µ–¥–Ω—è—è"
        distance_note = "–ë–ª–∏–∑–∫–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è"
    else:
        distance_threat = "–Ω–∏–∑–∫–∞—è"
        distance_note = "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ"
    
    # –û—Ü–µ–Ω–∫–∞ —É–≥—Ä–æ–∑—ã –ø–æ —Ä–∞–∑–º–µ—Ä—É
    diameter_m = abs(diameter_km) * 1000
    
    if diameter_m <= 25:
        size_threat = "–Ω–∏–∑–∫–∞—è"
        size_note = "–ü–æ–ª–Ω–æ–µ —Å–≥–æ—Ä–∞–Ω–∏–µ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –≤–µ—Ä–æ—è—Ç–Ω–æ"
        impact_category = "–ª–æ–∫–∞–ª—å–Ω—ã–π" if diameter_m > 10 else "–Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π"
    elif diameter_m <= 50:
        size_threat = "—Å—Ä–µ–¥–Ω—è—è"
        size_note = "–í–æ–∑–¥—É—à–Ω—ã–π –≤–∑—Ä—ã–≤, –≤–æ–∑–º–æ–∂–Ω—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏"
        impact_category = "—Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π"
    elif diameter_m <= 140:
        size_threat = "–≤—ã—Å–æ–∫–∞—è"
        size_note = "–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ, –∫—Ä—É–ø–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏"
        impact_category = "—Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π"
    else:
        size_threat = "–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è"
        size_note = "–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ, –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è"
        impact_category = "–≥–ª–æ–±–∞–ª—å–Ω—ã–π"
    
    # –û—Ü–µ–Ω–∫–∞ —É–≥—Ä–æ–∑—ã –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–æ—Ä–æ–≥–∏)
    if velocity_km_s >= 20:
        velocity_threat = "–≤—ã—Å–æ–∫–∞—è"
        velocity_note = "–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏—é –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è"
    elif velocity_km_s >= 15:
        velocity_threat = "—Å—Ä–µ–¥–Ω—è—è"
        velocity_note = "–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å"
    else:
        velocity_threat = "–Ω–∏–∑–∫–∞—è"
        velocity_note = "–°–∫–æ—Ä–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π"
    
    # –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —É–≥—Ä–æ–∑—ã
    threat_weights = {
        "–Ω–∏–∑–∫–∞—è": 1,
        "—Å—Ä–µ–¥–Ω—è—è": 2,
        "–≤—ã—Å–æ–∫–∞—è": 3,
        "–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è": 4
    }
    
    total_threat_score = (
        threat_weights[distance_threat] * 0.4 +
        threat_weights[size_threat] * 0.5 +
        threat_weights[velocity_threat] * 0.1
    )
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è —É–≥—Ä–æ–∑—ã (—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏)
    if total_threat_score >= 3.4:
        overall_threat = "–≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π"
        threat_level = "–≤—ã—Å–æ–∫–∞—è"
    elif total_threat_score >= 2.4:
        overall_threat = "—Å—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –∏–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä—É—à–µ–Ω–∏–π"
        threat_level = "—Å—Ä–µ–¥–Ω—è—è"
    else:
        overall_threat = "–Ω–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –∏–ª–∏ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è"
        threat_level = "–Ω–∏–∑–∫–∞—è"
    
    # –†–∞—Å—á–µ—Ç –∫–∏–Ω–µ—Ç–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏
    density = 2000
    radius = abs(diameter_m) / 2
    volume = (4/3) * math.pi * (radius ** 3)
    mass_kg = abs(volume * density)
    energy_joules = 0.5 * mass_kg * (abs(velocity_km_s) * 1000) ** 2
    energy_megatons = energy_joules / 4.184e15
    
    # –û—Ü–µ–Ω–∫–∞ —É—â–µ—Ä–±–∞
    if energy_megatons <= 1:
        damage_assessment = "–ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —É—â–µ—Ä–± (—Å–≥–æ—Ä–∞–Ω–∏–µ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ)"
    elif energy_megatons <= 10:
        damage_assessment = "–õ–æ–∫–∞–ª—å–Ω—ã–π —É—â–µ—Ä–± (—É–¥–∞—Ä–Ω–∞—è –≤–æ–ª–Ω–∞, –≤–æ–∑–º–æ–∂–Ω—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã)"
    elif energy_megatons <= 100:
        damage_assessment = "–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—â–µ—Ä–± (—Ä–∞–∑—Ä—É—à–µ–Ω–∏—è –≤ —Ä–∞–¥–∏—É—Å–µ –¥–µ—Å—è—Ç–∫–æ–≤ –∫–º)"
    elif energy_megatons <= 1000:
        damage_assessment = "–ö–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–∞–ª—å–Ω—ã–π —É—â–µ—Ä–± (–∫—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è)"
    else:
        damage_assessment = "–ì–ª–æ–±–∞–ª—å–Ω—ã–π —É—â–µ—Ä–± (–∫–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –º–∞—Å—Å–æ–≤—ã–µ –≤—ã–º–∏—Ä–∞–Ω–∏—è)"
    
    # –ù–û–í–´–ô –†–ê–ó–î–ï–õ: –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
    probability_analysis = calculate_impact_probability(
        distance_au=distance_au,
        velocity_km_s=velocity_km_s,
        earth_moid_au=earth_moid_au
    )
    
    # –ù–û–í–´–ô –†–ê–ó–î–ï–õ: –û—Ü–µ–Ω–∫–∞ –º–µ—Å—Ç–∞ –ø–∞–¥–µ–Ω–∏—è (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ –≤—Ä–µ–º—è —Å–±–ª–∏–∂–µ–Ω–∏—è)
    impact_location_analysis = None
    if approach_time:
        impact_location_analysis = estimate_impact_location(
            approach_time=approach_time,
            velocity_km_s=velocity_km_s,
            distance_au=distance_au
        )
    
    # –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑: —Å–≥–æ—Ä–∏—Ç –ª–∏ –∞—Å—Ç–µ—Ä–æ–∏–¥?
    atmosphere_analysis = analyze_atmospheric_entry(diameter_km, velocity_km_s)
    
    result = {
        "–≤—Ö–æ–¥–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ": {
            "–¥–∏–∞–º–µ—Ç—Ä_–∫–º": round(diameter_km, 3),
            "—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ_–∞–µ": round(distance_au, 4),
            "—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ_–∫–º": round(distance_km_value, 0),
            "—Å–∫–æ—Ä–æ—Å—Ç—å_–∫–º_—Å": float(round(velocity_km_s, 1)),
            "moid_–∞–µ": earth_moid_au,
            "–≤—Ä–µ–º—è_—Å–±–ª–∏–∂–µ–Ω–∏—è": approach_time.strftime("%Y-%m-%d %H:%M:%S") if approach_time else "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        },
        "–∞–Ω–∞–ª–∏–∑_–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤": {
            "–æ–ø–∞—Å–Ω–æ—Å—Ç—å_–ø–æ_—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é": distance_threat,
            "–ø–æ—è—Å–Ω–µ–Ω–∏–µ_—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è": distance_note,
            "–æ–ø–∞—Å–Ω–æ—Å—Ç—å_–ø–æ_—Ä–∞–∑–º–µ—Ä—É": size_threat,
            "–ø–æ—è—Å–Ω–µ–Ω–∏–µ_—Ä–∞–∑–º–µ—Ä–∞": size_note,
            "–æ–ø–∞—Å–Ω–æ—Å—Ç—å_–ø–æ_—Å–∫–æ—Ä–æ—Å—Ç–∏": velocity_threat,
            "–ø–æ—è—Å–Ω–µ–Ω–∏–µ_—Å–∫–æ—Ä–æ—Å—Ç–∏": velocity_note,
            "–∫–∞—Ç–µ–≥–æ—Ä–∏—è_–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è": impact_category
        },
        "–∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π_–∞–Ω–∞–ª–∏–∑": atmosphere_analysis,
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è": probability_analysis,
        "—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞": {
            "–∫–∏–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è_—ç–Ω–µ—Ä–≥–∏—è_–¥–∂": f"{energy_joules:.2e}",
            "—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç_–º–µ–≥–∞—Ç–æ–Ω–Ω": round(energy_megatons, 1)
        },
        "–∏—Ç–æ–≥–æ–≤–∞—è_–æ—Ü–µ–Ω–∫–∞": {
            "—Å—Ç–µ–ø–µ–Ω—å_—É–≥—Ä–æ–∑—ã": threat_level,
            "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–∏_–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è": overall_threat,
            "–æ—Ü–µ–Ω–∫–∞_—É—â–µ—Ä–±–∞_–ø—Ä–∏_–ø–∞–¥–µ–Ω–∏–∏": damage_assessment,
            "–æ–±—â–∏–π_–±–∞–ª–ª_—É–≥—Ä–æ–∑—ã": round(total_threat_score, 2)
        }
    }
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ –º–µ—Å—Ç–∞ –ø–∞–¥–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
    if impact_location_analysis:
        result["–æ—Ü–µ–Ω–∫–∞_–º–µ—Å—Ç–∞_–ø–∞–¥–µ–Ω–∏—è"] = impact_location_analysis
    
    return result


def analyze_atmospheric_entry(diameter_km: float, velocity_km_s: float) -> Dict[str, Any]:
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç, —Å–≥–æ—Ä–∏—Ç –ª–∏ –∞—Å—Ç–µ—Ä–æ–∏–¥ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –ó–µ–º–ª–∏.
    
    Args:
        diameter_km: –î–∏–∞–º–µ—Ç—Ä –∞—Å—Ç–µ—Ä–æ–∏–¥–∞ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
        velocity_km_s: –°–∫–æ—Ä–æ—Å—Ç—å –≤ –∫–º/—Å
        
    Returns:
        –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É
    """
    diameter_m = diameter_km * 1000
    
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–≥–æ—Ä–∞–Ω–∏—è –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ
    # –ú–∞–ª–µ–Ω—å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã (< 25 –º) –æ–±—ã—á–Ω–æ —Å–≥–æ—Ä–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
    # –°—Ä–µ–¥–Ω–∏–µ (25-50 –º) –º–æ–≥—É—Ç –≤–∑–æ—Ä–≤–∞—Ç—å—Å—è –≤ –≤–æ–∑–¥—É—Ö–µ
    # –ö—Ä—É–ø–Ω—ã–µ (> 50 –º) –¥–æ—Å—Ç–∏–≥–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    
    if diameter_m < 10:
        fate = "–ø–æ–ª–Ω–æ–µ —Å–≥–æ—Ä–∞–Ω–∏–µ"
        probability = ">99%"
        altitude = "70-50 –∫–º"
        effect = "—è—Ä–∫–∏–π –±–æ–ª–∏–¥, –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—è–≤–ª–µ–Ω–∏–µ –º–µ—Ç–µ–æ—Ä–∏—Ç–Ω–æ–≥–æ –¥–æ–∂–¥—è"
    elif diameter_m < 25:
        fate = "–ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ–µ —Å–≥–æ—Ä–∞–Ω–∏–µ"
        probability = "90-99%"
        altitude = "50-30 –∫–º"
        effect = "–≤–æ–∑–¥—É—à–Ω—ã–π –≤–∑—Ä—ã–≤, —Ä–µ–¥–∫–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ—Å—Ç–∏–≥–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏"
    elif diameter_m < 50:
        fate = "—á–∞—Å—Ç–∏—á–Ω–æ–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ"
        probability = "50-90%"
        altitude = "30-15 –∫–º"
        effect = "–∫—Ä—É–ø–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ—Å—Ç–∏–≥–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏, —É–¥–∞—Ä–Ω–∞—è –≤–æ–ª–Ω–∞"
    elif diameter_m < 100:
        fate = "–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ"
        probability = "10-50%"
        altitude = "15-5 –∫–º"
        effect = "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Ç–µ—Ä–∞, —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è"
    else:
        fate = "–ø–æ–ª–Ω–æ–µ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ"
        probability = "<10%"
        altitude = "–¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏"
        effect = "–∫—Ä—É–ø–Ω—ã–π –∫—Ä–∞—Ç–µ—Ä, –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è"
    
    # –í–ª–∏—è–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
    if velocity_km_s > 20:
        speed_effect = "–≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä–µ–≤ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–∑—Ä—ã–≤–∞"
        fate_modifier = "–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è"
    elif velocity_km_s > 15:
        speed_effect = "—Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π"
        fate_modifier = "—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ"
    else:
        speed_effect = "–Ω–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —É–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–≥—Ä–µ–≤"
        fate_modifier = "–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏"
    
    return {
        "—Å—É–¥—å–±–∞_–≤_–∞—Ç–º–æ—Å—Ñ–µ—Ä–µ": fate,
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è_–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏": probability,
        "–æ–∂–∏–¥–∞–µ–º–∞—è_–≤—ã—Å–æ—Ç–∞_—Ä–∞–∑—Ä—É—à–µ–Ω–∏—è": altitude,
        "—ç—Ñ—Ñ–µ–∫—Ç": effect,
        "–≤–ª–∏—è–Ω–∏–µ_—Å–∫–æ—Ä–æ—Å—Ç–∏": speed_effect,
        "–º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä_—Å—É–¥—å–±—ã": fate_modifier,
        "–¥–∏–∞–º–µ—Ç—Ä_–º–µ—Ç—Ä—ã": round(diameter_m, 1)
    }


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
def estimate_trajectory_uncertainty(distance_au: float, observation_count: int = 10) -> Dict[str, Any]:
    """
    –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.
    
    Args:
        distance_au: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ó–µ–º–ª–∏
        observation_count: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (–æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã—Ö –¥—É–≥)
        
    Returns:
        –û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
    """
    # –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
    base_uncertainty_km = 1000 / max(1, observation_count ** 0.5)
    
    # –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
    distance_factor = 1 + (distance_au * 10)
    uncertainty_km = base_uncertainty_km * distance_factor
    
    # –ü–µ—Ä–µ–≤–æ–¥ –≤ —É–≥–ª–æ–≤—ã–µ —Å–µ–∫—É–Ω–¥—ã (–¥–ª—è –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π)
    if distance_au > 0:
        uncertainty_arcsec = (uncertainty_km / (distance_au * 149597870.7)) * 206265
    else:
        uncertainty_arcsec = 3600  # –±–æ–ª—å—à–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
    
    # –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
    if uncertainty_km < 100:
        quality = "–æ—Ç–ª–∏—á–Ω–∞—è"
        color = "üü¢"
    elif uncertainty_km < 1000:
        quality = "—Ö–æ—Ä–æ—à–∞—è"
        color = "üü°"
    elif uncertainty_km < 10000:
        quality = "—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è"
        color = "üü†"
    else:
        quality = "–ø–ª–æ—Ö–∞—è"
        color = "üî¥"
    
    return {
        "–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å_–∫–º": round(uncertainty_km, 0),
        "–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å_—É–≥–ª–æ–≤—ã–µ_—Å–µ–∫—É–Ω–¥—ã": round(uncertainty_arcsec, 1),
        "–∫–∞—á–µ—Å—Ç–≤–æ_–æ—Ä–±–∏—Ç—ã": quality,
        "–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä": color,
        "—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è": "–¢—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è" if quality in ["—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è", "–ø–ª–æ—Ö–∞—è"] else "–û—Ä–±–∏—Ç–∞ —Ö–æ—Ä–æ—à–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞",
        "–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ_–Ω–∞–±–ª—é–¥–µ–Ω–∏–π": max(0, 50 - observation_count) if quality in ["—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è", "–ø–ª–æ—Ö–∞—è"] else 0
    }
    
    