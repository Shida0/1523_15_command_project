# üèóÔ∏è **–û–ë–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´**

## üìã **–û–ë–ó–û–†**

–û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`shared/`) —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –≤—Å–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –≠—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –µ–¥–∏–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –¥—Ä—É–≥–∏—Ö –≤–∞–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

## ‚öôÔ∏è **–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (config)**

### **ConfigManager**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/config/config_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ —Ñ–∞–π–ª–æ–≤.

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `database`: `DatabaseConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `nasa_api`: `NasaApiConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API NASA
- `application`: `ApplicationConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `_loaded_from`: `str` - –ø—É—Ç—å, –æ—Ç–∫—É–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ú–µ—Ç–æ–¥—ã:**
- `load_from_file(config_path: Union[str, Path]) -> 'ConfigManager'`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞ YAML –∏–ª–∏ JSON
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `config_path` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `ConfigManager` - —Å–∞–º —ç–∫–∑–µ–º–ø–ª—è—Ä
  - **–ü—Ä–∏–º–µ—Ä:**
```python
from shared.config.config_manager import ConfigManager
config = ConfigManager().load_from_file('./config.yaml')
```

- `validate() -> bool`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `bool` - —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏

- `get_database_url() -> str`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `str` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

- `get_log_level() -> str`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `str` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- `is_production() -> bool`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω–æ –ª–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `bool` - —è–≤–ª—è–µ—Ç—Å—è –ª–∏ production –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º

### **DatabaseConfig**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `host` (str): –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `port` (int): –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `user` (str): –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `password` (str): –ü–∞—Ä–æ–ª—å –∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `db_name` (str): –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Ç–æ–¥—ã:**
- `dsn` (property): –ü–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### **NasaApiConfig**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API NASA

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `base_url` (str): –ë–∞–∑–æ–≤—ã–π URL API NASA
- `rate_limit_requests` (int): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
- `rate_limit_period` (int): –ü–µ—Ä–∏–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `timeout` (int): –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `retry_attempts` (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–∞
- `sbdb_timeout` (int): –¢–∞–π–º–∞—É—Ç API SBDB
- `cad_timeout` (int): –¢–∞–π–º–∞—É—Ç API CAD
- `sentry_timeout` (int): –¢–∞–π–º–∞—É—Ç API Sentry

### **ApplicationConfig**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `environment` (str): –û–∫—Ä—É–∂–µ–Ω–∏–µ (dev, prod, test)
- `log_level` (str): –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `debug` (bool): –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
- `update_interval_minutes` (int): –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –º–∏–Ω—É—Ç–∞—Ö
- `max_concurrent_updates` (int): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `enable_monitoring` (bool): –í–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `monitoring_port` (int): –ü–æ—Ä—Ç –¥–ª—è —Ç–æ—á–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
- `get_config() -> ConfigManager`: –ü–æ–ª—É—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `set_config(config: ConfigManager)`: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üóÑÔ∏è **–ë–ê–ó–ê –î–ê–ù–ù–´–• (database)**

### **AsyncEngine –∏ SessionFactory**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/database/engine.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ –∏ —Ñ–∞–±—Ä–∏–∫–∏ —Å–µ—Å—Å–∏–π –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `async_engine`: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ SQLAlchemy
- `AsyncSessionLocal`: –§–∞–±—Ä–∏–∫–∞ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- `get_async_session()`: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å FastAPI - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏—é –±–µ–∑ –∞–≤—Ç–æ–∫–æ–º–∏—Ç–∞
- `close_async_engine()`: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
from shared.database.engine import get_async_session, close_async_engine

# –í FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
async def get_db():
    async with get_async_session() as session:
        yield session

# –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
await close_async_engine()
```

## üåê **–í–ù–ï–®–ù–ò–ï API (external_api)**

### **NASASBDBClient**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/external_api/clients/sbdb_api.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å NASA Small-Body Database

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `timeout` (int): –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `max_workers` (int): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–æ–≤
- `batch_size` (int): –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `delay_between_batches` (float): –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
- `session` (Optional[aiohttp.ClientSession]): HTTP-—Å–µ—Å—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞

**–ú–µ—Ç–æ–¥—ã:**
- `get_asteroids(limit: Optional[int] = None) -> List[Dict[str, Any]]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –∞—Å—Ç–µ—Ä–æ–∏–¥–∞—Ö
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `limit` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `List[Dict[str, Any]]` - —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö –æ–± –∞—Å—Ç–µ—Ä–æ–∏–¥–∞—Ö
  - **–ü—Ä–∏–º–µ—Ä:**
```python
from shared.external_api.clients.sbdb_api import NASASBDBClient

async with NASASBDBClient() as client:
    asteroids = await client.get_asteroids(limit=10)
    print(f"–ü–æ–ª—É—á–µ–Ω–æ {len(asteroids)} –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤")
```

- `_fetch_with_astroquery(designation: str) -> Optional[Dict[str, Any]]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ astroquery –¥–ª—è –æ–¥–Ω–æ–≥–æ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `designation` - –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Optional[Dict[str, Any]]` - –¥–∞–Ω–Ω—ã–µ –æ–± –∞—Å—Ç–µ—Ä–æ–∏–¥–µ –∏–ª–∏ None

- `_parse_astroquery_result(data: Dict, designation: str) -> Dict[str, Any]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞—Ä—Å–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç astroquery –≤ —Ñ–æ—Ä–º–∞—Ç AsteroidModel
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `data` - –¥–∞–Ω–Ω—ã–µ –∏–∑ astroquery, `designation` - –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Dict[str, Any]` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞

### **CADClient**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/external_api/clients/cad_api.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Å–±–ª–∏–∂–µ–Ω–∏—è—Ö

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `timeout` (int): –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `session` (Optional[aiohttp.ClientSession]): HTTP-—Å–µ—Å—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞

**–ú–µ—Ç–æ–¥—ã:**
- `get_close_approaches(asteroid_ids: Optional[List[str]] = None, start_date: Optional[datetime] = None, end_date: Optional[datetime] = None, max_distance_au: float = 0.05) -> Dict[str, List[Dict[str, Any]]]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–±–ª–∏–∂–µ–Ω–∏—è—Ö –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤ —Å –ó–µ–º–ª–µ–π
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `asteroid_ids`, `start_date`, `end_date`, `max_distance_au`
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Dict[str, List[Dict[str, Any]]]` - –¥–∞–Ω–Ω—ã–µ –æ —Å–±–ª–∏–∂–µ–Ω–∏—è—Ö
  - **–ü—Ä–∏–º–µ—Ä:**
```python
from shared.external_api.clients.cad_api import CADClient
from datetime import datetime, timedelta

async with CADClient() as client:
    approaches = await client.get_close_approaches(
        start_date=datetime.now(),
        end_date=datetime.now() + timedelta(days=365),
        max_distance_au=0.05
    )
    print(f"–ü–æ–ª—É—á–µ–Ω–æ —Å–±–ª–∏–∂–µ–Ω–∏–π: {sum(len(v) for v in approaches.values())}")
```

- `_process_cad_response(cad_data: Dict[str, Any], filter_ids: Optional[List[str]] = None) -> Dict[str, List[Dict[str, Any]]]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç CAD API –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–≥–æ –≤ —Ñ–æ—Ä–º–∞—Ç —Å–±–ª–∏–∂–µ–Ω–∏–π
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `cad_data`, `filter_ids`
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Dict[str, List[Dict[str, Any]]]` - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### **SentryClient**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/external_api/clients/sentry_api.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ä–∏—Å–∫–∞—Ö —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π

**–ê—Ç—Ä–∏–±—É—Ç—ã:**
- `timeout` (int): –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `session` (Optional[aiohttp.ClientSession]): HTTP-—Å–µ—Å—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞

**–ú–µ—Ç–æ–¥—ã:**
- `fetch_current_impact_risks() -> List[SentryImpactRisk]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π —Å ts_max > 0
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `List[SentryImpactRisk]` - —Å–ø–∏—Å–æ–∫ —Ä–∏—Å–∫–æ–≤ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
  - **–ü—Ä–∏–º–µ—Ä:**
```python
from shared.external_api.clients.sentry_api import SentryClient

async with SentryClient() as client:
    risks = await client.fetch_current_impact_risks()
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(risks)} –æ–±—ä–µ–∫—Ç–æ–≤ —Å —Ä–∏—Å–∫–æ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è")
```

- `fetch_object_details(designation: str) -> Optional[SentryImpactRisk]`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `designation` - –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Optional[SentryImpactRisk]` - –¥–µ—Ç–∞–ª–∏ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ None

- `_parse_sentry_item(item: Dict[str, Any]) -> SentryImpactRisk`:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞—Ä—Å–∏—Ç —ç–ª–µ–º–µ–Ω—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Sentry API –≤ –æ–±—ä–µ–∫—Ç SentryImpactRisk
  - **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** `item` - —ç–ª–µ–º–µ–Ω—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
  - **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `SentryImpactRisk` - –æ–±—ä–µ–∫—Ç —Ä–∏—Å–∫–∞

## üõ°Ô∏è **–ú–ï–•–ê–ù–ò–ó–ú–´ –û–¢–ö–ê–ó–û–£–°–¢–û–ô–ß–ò–í–û–°–¢–ò (resilience)**

### **Circuit Breaker**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/resilience/circuit_breaker.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ—Ä—ã–≤–∞—Ç–µ–ª—å —Ü–µ–ø–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤.

### **Bulkhead**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/resilience/bulkhead.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–æ–±–ª–µ–º.

### **Timeout**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/resilience/timeout.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–µ—Ö–∞–Ω–∏–∑–º—ã —Ç–∞–π–º–∞—É—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è.

## üßÆ **–ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –£–¢–ò–õ–ò–¢–´ (utils)**

### **space_math**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/utils/space_math.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Å—Ñ–µ—Ä–µ.

**–§—É–Ω–∫—Ü–∏–∏:**
- `get_size_by_albedo(albedo: float, h_mag: float) -> float`: –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ –∞–ª—å–±–µ–¥–æ –∏ H-–≤–µ–ª–∏—á–∏–Ω–µ
- `get_size_by_h_mag(h_mag: float) -> float`: –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ H-–≤–µ–ª–∏—á–∏–Ω–µ

### **get_date**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/utils/get_date.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏.

### **error_handlers**
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/utils/error_handlers.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥—É–ª—å —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫.

**–î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã:**
- `retry_with_exponential_backoff`: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- `nasa_api_endpoint`: –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ NASA API
- `database_operation`: –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `log_execution_time`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
- `validate_response`: –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ API
- `fallback_on_error`: –í–æ–∑–≤—Ä–∞—Ç fallback –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `APIError`: –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –æ—à–∏–±–æ–∫ API
- `NASAAPIError`: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å NASA API
- `RateLimitExceededError`: –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ NASA API
- `NetworkError`: –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞
- `DataParseError`: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö
- `DatabaseError`: –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üß™ **–ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –û–ë–©–ò–• –ö–û–ú–ü–û–ù–ï–ù–¢–û–í**

### **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```python
from shared.config.config_manager import get_config

# –ü–æ–ª—É—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
config = get_config()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
db_url = config.get_database_url()
log_level = config.get_log_level()
is_prod = config.is_production()

print(f"–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: {db_url}")
print(f"–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: {log_level}")
print(f"Production —Ä–µ–∂–∏–º: {is_prod}")
```

### **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö API:**
```python
from shared.external_api.clients.sbdb_api import NASASBDBClient
from shared.external_api.clients.cad_api import CADClient
from shared.external_api.clients.sentry_api import SentryClient

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± –∞—Å—Ç–µ—Ä–æ–∏–¥–∞—Ö
async with NASASBDBClient() as sbdb_client:
    asteroids = await sbdb_client.get_asteroids(limit=5)
    print(f"–ü–æ–ª—É—á–µ–Ω–æ {len(asteroids)} –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤")

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–±–ª–∏–∂–µ–Ω–∏—è—Ö
async with CADClient() as cad_client:
    approaches = await cad_client.get_close_approaches(max_distance_au=0.02)
    print(f"–ü–æ–ª—É—á–µ–Ω–æ {len(approaches)} —Å–±–ª–∏–∂–µ–Ω–∏–π")

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ä–∏—Å–∫–∞—Ö
async with SentryClient() as sentry_client:
    risks = await sentry_client.fetch_current_impact_risks()
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(risks)} —Ä–∏—Å–∫–æ–≤ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è")
```

### **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Ç–∏–ª–∏—Ç:**
```python
from shared.utils.space_math import get_size_by_albedo, get_size_by_h_mag
from shared.utils.error_handlers import retry_with_exponential_backoff

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
size1 = get_size_by_albedo(albedo=0.15, h_mag=20.5)
size2 = get_size_by_h_mag(h_mag=18.0)

print(f"–†–∞–∑–º–µ—Ä –ø–æ –∞–ª—å–±–µ–¥–æ: {size1} –∫–º")
print(f"–†–∞–∑–º–µ—Ä –ø–æ H-–≤–µ–ª–∏—á–∏–Ω–µ: {size2} –∫–º")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
@retry_with_exponential_backoff(max_attempts=3)
async def unreliable_function():
    # –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞
    pass
```

---

**–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª:** [–ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê](infrastructure.md) - –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, —Å—Ö–µ–º –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π